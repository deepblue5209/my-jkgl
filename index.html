<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家庭健康记录</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div class="container">
        <header>
            <h1><i class="fas fa-heartbeat"></i> 家庭健康记录</h1>
            <div class="header-info">
                <div class="datetime-group">
                    <p class="date" id="currentDate">加载中...</p>
                    <p class="time" id="currentTime"></p>
                </div>

                <div class="user-tabs" id="userTabs">
                    <span class="user-tab active" data-user="Me" onclick="switchUser('Me')">我</span>
                    <span class="user-tab" data-user="Wife" onclick="switchUser('Wife')">老婆</span>
                    <span class="user-tab" data-user="Family" onclick="switchUser('Family')">家人</span>
                </div>
            </div>
        </header>

        <section class="card water-section">
            <h2><i class="fas fa-tint" style="color: var(--water);"></i> 喝水记录 (当前用户: <span
                    id="currentUserName_Water">我</span>)</h2>
            <div class="water-info">
                <span id="waterTotal">0 ml</span>
                <span class="water-goal">目标: 2000 ml</span>
            </div>
            <div class="progress-container">
                <div class="progress-bar" id="waterBar">
                    <span class="progress-text" id="progressText">0%</span>
                </div>
            </div>
            <div class="water-controls">
                <button class="btn-water" onclick="addRecord('water', 200)"><i class="fas fa-plus"></i> 200ml</button>
                <button class="btn-water" onclick="addRecord('water', 350)"><i class="fas fa-plus"></i> 350ml</button>
                <button class="btn-water" onclick="addRecord('water', 500)"><i class="fas fa-plus"></i> 500ml</button>
            </div>
        </section>

        <section class="card weight-section">
            <h2><i class="fas fa-weight" style="color: var(--weight);"></i> 体重记录 (当前用户: <span
                    id="currentUserName_Weight">我</span>)</h2>
            <div class="weight-fields">
                <input type="number" id="weightInput" placeholder="体重 (kg)" step="0.1" min="1">
                <input type="number" id="bodyFatInput" placeholder="体脂率 (%)" step="0.1" min="1" max="100">
                <div class="calculated-bmi" id="bmiDisplay">BMI: N/A</div>
            </div>
            <div class="input-group">
                <button class="btn-weight" onclick="addWeight()"><i class="fas fa-upload"></i> 记录体重/体脂</button>
            </div>
        </section>

        <section class="card sleep-section">
            <h2><i class="fas fa-moon" style="color: var(--sleep);"></i> 睡眠记录 (当前用户: <span
                    id="currentUserName_Sleep">我</span>)</h2>
            <div class="input-group">
                <input type="text" id="sleepTime" placeholder="例如: 7h 30min">
                <button class="btn-sleep" onclick="addSleep()"><i class="fas fa-bed"></i> 记录睡眠</button>
            </div>
        </section>

        <section class="card food-section">
            <h2><i class="fas fa-utensils" style="color: var(--food);"></i> 饮食记录 (当前用户: <span
                    id="currentUserName_Food">我</span>)</h2>

            <div id="calorieTotalDisplay"
                style="text-align: right; margin-bottom: 20px; font-size: 1.1rem; font-weight: bold; color: var(--food-dark);">
                今日总摄入: <span id="totalCalories">0</span> Kcal
            </div>

            <!-- Breakfast -->
            <div class="diet-meal-group" id="mealGroup_breakfast">
                <div class="input-group">
                    <input type="text" id="foodInput_breakfast" placeholder="早餐内容...">
                    <input type="number" id="calorieInput_breakfast" placeholder="热量(Kcal)" min="0"
                        style="flex: 0.5; min-width: 80px;">
                    <button class="btn-food meal-record-btn" id="recordBtn_breakfast" onclick="addMeal('breakfast')"><i
                            class="fas fa-check"></i> 记录</button>
                    <button class="btn-edit meal-edit-btn" id="editBtn_breakfast" onclick="editMeal('breakfast')"
                        style="display:none;"><i class="fas fa-edit"></i> 修改</button>
                </div>
                <div class="meal-content-display" id="display_breakfast" style="display: none;"></div>
            </div>

            <!-- Lunch -->
            <div class="diet-meal-group" id="mealGroup_lunch">
                <div class="input-group">
                    <input type="text" id="foodInput_lunch" placeholder="午餐内容...">
                    <input type="number" id="calorieInput_lunch" placeholder="热量(Kcal)" min="0"
                        style="flex: 0.5; min-width: 80px;">
                    <button class="btn-food meal-record-btn" id="recordBtn_lunch" onclick="addMeal('lunch')"><i
                            class="fas fa-check"></i> 记录</button>
                    <button class="btn-edit meal-edit-btn" id="editBtn_lunch" onclick="editMeal('lunch')"
                        style="display:none;"><i class="fas fa-edit"></i> 修改</button>
                </div>
                <div class="meal-content-display" id="display_lunch" style="display: none;"></div>
            </div>

            <!-- Dinner -->
            <div class="diet-meal-group" id="mealGroup_dinner">
                <div class="input-group">
                    <input type="text" id="foodInput_dinner" placeholder="晚餐内容...">
                    <input type="number" id="calorieInput_dinner" placeholder="热量(Kcal)" min="0"
                        style="flex: 0.5; min-width: 80px;">
                    <button class="btn-food meal-record-btn" id="recordBtn_dinner" onclick="addMeal('dinner')"><i
                            class="fas fa-check"></i> 记录</button>
                    <button class="btn-edit meal-edit-btn" id="editBtn_dinner" onclick="editMeal('dinner')"
                        style="display:none;"><i class="fas fa-edit"></i> 修改</button>
                </div>
                <div class="meal-content-display" id="display_dinner" style="display: none;"></div>
            </div>
        </section>

        <section class="card fitness-section">
            <h2><i class="fas fa-dumbbell" style="color: var(--fitness);"></i> 运动记录</h2>
            <div class="input-group">
                <button class="btn-fitness" onclick="addFitness()"><i class="fas fa-plus"></i> 记录运动</button>
            </div>
        </section>

        <section class="card body-section">
            <h2><i class="fas fa-restroom" style="color: var(--body);"></i> 生理记录 (当前用户: <span
                    id="currentUserName_Body">我</span>)</h2>
            <div class="body-controls">
                <button class="btn-pee" onclick="addRecord('pee', '小便')"><i class="fas fa-tint"></i> 记录小便</button>
                <button class="btn-poop" onclick="addRecord('poop', '大便')"><i class="fas fa-poop"></i> 记录大便</button>
            </div>
        </section>

        <section class="card summary-section">
            <h2><i class="fas fa-chart-bar" style="color: var(--text);"></i> 数据汇总 (今日 VS 昨日)</h2>
            <div id="summaryComparison">
                <p style="text-align: center; color: var(--text-light);">数据加载中...</p>
            </div>
        </section>

        <section class="card log-section">
            <h2><i class="fas fa-list-alt" style="color: var(--text);"></i> 今日动态</h2>
            <div style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                <label for="logSort" style="font-size: 0.9rem; color: var(--text-light);">排序方式:</label>
                <select id="logSort" onchange="saveAndRender()" style="flex: 1;">
                    <option value="user_category">按用户 > 类别</option>
                    <option value="category">按类别 (默认)</option>
                    <option value="time">按时间 (倒序)</option>
                </select>
            </div>
            <ul class="log-list" id="logList">
                <!-- Dynamic Content -->
            </ul>
            <div class="action-buttons">
                <button class="btn-export" onclick="exportDataToCSV()"><i class="fas fa-file-export"></i> 导出数据</button>
                <button class="btn-clear" onclick="clearData()"><i class="fas fa-trash-alt"></i> 清空今日数据</button>
            </div>
        </section>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">操作成功</span>
    </div>

    <script src="js/script.js"></script>
</body>

</html>